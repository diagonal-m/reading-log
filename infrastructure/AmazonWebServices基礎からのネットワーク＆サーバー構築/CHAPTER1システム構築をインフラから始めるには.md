## 1-1 開発者がネットワークやサーバーを構築するメリット
> [!tip] 障害に強くなる
- システムにトラブルがあったときに、どこに問題があるのか、切り分けられるようになる

> [!tip] アプリケーション開発の枠組みだけでなく、どこに問題があるか、切り分けられるようになる
- インフラを知らなければ、アプリケーション開発の枠組みの範囲でしか対応できない
- インフラを知っていれば、ネットワークやサーバーを増強して対策をとるなど、システム全体で対応できるようになる

## 1-2 ネットワークやサーバーを構築する
> [!quote] ネットワーク管理者やサーバー管理者は、概ね次のようにシステム全体を設計する
### ■ サーバーの構成
1. まずどのようなサーバーが必要なのかを考える
	1. Webサイト: Webサーバー
	2. データを保存: データベースサーバー
	3. メールの送受信: メールサーバー

> [!MEMO] 実際には、「Webサーバー」や「データベースサーバー」、「メールサーバー」というものがあるわけではなく、「サーバーに対してWebの機能を提供するソフトウェアをインストールしたもの」がWebサーバーであり、同様に「データベースの機能を提供するソフトウェアをインストールしたもの」がデータベースサーバー、「メールの送受信機能を提供するソフトウェアをインストールしたもの」がメールサーバーである

> [!MEMO] そもそもサーバーというのは、「Linux」や「Windows Server」など、サーバー用のOSをインストールしたコンピュータのことに過ぎない


 **サーバーを構築したいのであれば、次の知識の習得が必要**
1. サーバーOSのインストール方法
	 1. LinuxやWindows ServerなどのサーバーOSのインストール、そして、各種の設定方法

2. 各ソフトウェアのインストールや設定方法
	1. Webサーバーソフトやデータベースソフト、メールサーバーソフトなど、さまざまな機能を提供するソフトウェアのインストールや設定方法
		1. Webサーバーとして機能させたいなら、「Apache HTTP Server」や「nginx」などのソフトウェアをインストールする
		2. データベースサーバーとして機能させたいなら、「MySQL」や「MariaDB」「PostgreSQL」などのソフトウェアをインストールする
		3. メールサーバーとして機能させたいなら「Postfix」などのソフトウェアをインストールする

### ■ ネットワークの構成
> [!MEMO] 構築したサーバーは、ネットワークに接続しないと、通信できない。インターネットと接続可能なネットワークでは、「TCP/IP(Transmission Control Protocol/Internet Protocol)」

> [!MEMO] TCP/IPでは、それぞれのサーバーに「IPアドレス」という「10.0.1.10」のような他の機器と重複しない「ピリオドで区切られた4つの数字」を振る。

> [!MEMO] インターネットに接続する場合には、通常「ルーター」と呼ばれる機器を使うが、各サーバーでは、そのルーターにデータが流れるように構成しておかないとインターネットと通信できない

> [!MEMO] インターネットでは、「`http://www.example.co.jp`」のようなドメイン名でアクセスする。ドメイン名とは、サーバーのIPアドレスに付与する、人間が理解しやすい名前のようなものである。ドメイン名を使うためには、「DNSサーバー」と呼ばれるサーバーの設定も必要

**ネットワークを構築したいのであれば、次の知識の習得が必要**
1. IPアドレスに関する知識
	1. IPアドレスを、どのように定めるのか
	2. ルーターを介したインターネットとのデータの流れをどのように、制御するかのなどの知識

2. DNSサーバーに関する知識
	1. ドメイン名とIPアドレスを結びつけるには、どのようにすればよいのか。どのようなやりとりで、ドメイン名とIPアドレスとは、相互に変換されているのかなどの知識

## 1-3 WordPressでブログシステムを作る
> [!quote] 本書では、具体的に、WordPressでブログシステムを作りながら、「サーバーの構築」「ネットワークの構築」、そして、「問題を解決するツール」を説明していきます。
> 利用するサーバーは「Webサーバー」と「DBサーバー」の2台です。
> ...
> 本書では、何もないところから、サーバーやネットワークを構築していきます。

### ■「公開されたネットワーク」と「隠されたネットワーク」
- 本書で構築するネットワークは、２つに分かれている
	- **パブリックサブネット**
		- インターネットに接続し、「公開」されている。
		- ここにはWebサーバーを配置する
	- **プライベートサブネット**
		- インターネットに直接接続せず、「隠されたネットワーク」とする
		- ここにはDBサーバーを配置する

### ■ 片方向からの接続だけを許すNAT
- とはいえ、DBサーバーが、まったくインターネットにアクセスできないのは困る
	- ソフトウェアをインターネットからダウンロードしてインストールしたりアップデートしたりできなくなる
- そこでNATを導入する
> [!NOTE] NATはNetwork Address Translationの略で、内部だけで通用するアドレスを外部とも通信できるアドレスに変換する技術である
> NATを導入すると、「片方向だけの接続を許す」ことが実現できる。つまり、DBサーバーからはインターネットに接続できるけれども、逆に、インターネットからDBサーバーには接続できないという環境を実現する


## 1-4 物理的なネットワークとAWS
> [!quote] 本書では、「アマゾン ウェブ サービス(AWS)」を使って、ネットワークやサーバーを構築していきます。

### ■ 「リージョン」と「アベイラビリティーゾーン」
- AWSは本書の執筆時点で世界31ヶ所の分散されたデータセンター群で構成されている
	- それぞれの地域に存在するデータセンター群のことを「リージョン」と呼ぶ
		- e.g.) 「バージニアリージョン」「オレゴンリージョン」「東京リージョン」
	- リージョンはさらに、「アベイラビリティーゾーン(Availability Zone: 「AZ」)」に分割される

- AWSで仮想的なネットワーク(Amazon VPC(Amazon Virtual Private Cloud))や仮想的なサーバー(Amazon EC2(Amazon Elastic Compute Cloud)インスタンス)を構築する場合、それを「どのリージョンのどのアベイラビリティーゾーンに置くのか」を決めなければならない
- 通常AWSでは、データセンター全停止などの大きな障害に備えて、複数のアベイラビリティーゾーンにAmazon EC2インスタンスを配置して、耐障害性を高めることを推奨している

> [!quote] 本書では、演習のやりやすさから、「東京リージョン」の１つのアベイラビリティーゾーンに、すべてのEC2インスタンスを配置することにします

### ■ 「ネットワーク」と「Amazon VPC」
- AWSでは、Amazon VPCと呼ばれる領域を作ると、そこに自由なネットワークを作れる
- Amazon VPCを作るときには、「どのようなIPアドレス範囲を使うか」を指定する
[![Image from Gyazo](https://i.gyazo.com/b55d0c497404b8befe7586d053045ed9.jpg)](https://gyazo.com/b55d0c497404b8befe7586d053045ed9)
- Amazon VPCを作ったら、それをいくつかのネットワークにさらに分割して利用する
	- 分割したネットワークのことを「サブネット」という
	- サブネットの中には、次に説明する「サーバー(Amazon EC2 インスタンス)」を配置できる

### ■ 「サーバー」と「Amazon EC2 インスタンス」
- AWSでは「Amazon EC2」というサービスを使ってサーバーを作る
- 起動した各サーバー個体は「インスタンス」と呼ぶ
	- インスタンスを作るときは、「CPUのスペック」や「ディスクの容量」などを決められる
> [!quote] 本書では、実験なので、契約してから1年間の無償利用範囲に含まれている「t2.micro」というインスタンスタイプを使います。

## 1-5 本書の流れ
> [!quote] AWSを使って、WordPressによるブログシステムを構築しながら、ネットワーク技術やサーバー技術を習得していきます。本書は、次の章でで構成しています。

### CHAPTER2 ネットワークを構築する
> [!quote] まずは、システムの土台となるネットワークを設計します。ここで、どのようなIPアドレスを割り当てるべきなのかについても検討します。そしてインターネット側から見える「パブリックサブネット」を構築します

### CHAPTER3 サーバーを構築する
> [!quote] Amazon EC2を使ってサーバーを構築します。サーバーに対して設定するファイアウォールについても説明します。

### CHAPTER4 Webサーバーソフトをインストールする
> [!quote] CHAPTER3で構築したサーバーに、Apacheをインストールして、Webサーバーとして構成します。また、DNSを設定して、ドメイン名でアクセスできるようにします。

### CHAPTER5 HTTPの動きを確認する
> [!quote] Webサーバーでは、HTTP(Hyper Text Transfer Protocol)というプロトコルを使って通信します。デバッグツールを使って、実際に、どのようなデータが送受信されているのかをのぞき見ます。

### CHAPTER6 プライベートサブネットを構築する
> [!quote]  インターネットからは見えない「プライベートサブネット」を作り、DBサーバーを配置します。

### CHAPTER7 NATを構築する
> [!quote] CHAPTER6で構築したネットワークからインターネットに接続できるようにするため、NATを構築します。

### CHAPTER8 DBを用いたブログシステムの構築
> [!quote] DBサーバーにMariaDBをインストールして、データベースサーバーとして構成したあと、WebサーバーにWordPressをインストールし、ブログシステムを完成させます。

### CHAPTER9 TCP/IPによる通信の仕組みを理解する
> [!quote] 最後に、今まで解説してきたことのおさらいと、今後どういったことについて学習していくべきなのかという点に触れた、本書のまとめとします。

[![Image from Gyazo](https://i.gyazo.com/3b117936f8849e1d1f6b06c97605ef74.jpg)](https://gyazo.com/3b117936f8849e1d1f6b06c97605ef74)
